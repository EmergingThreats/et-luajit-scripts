##### Existing Rules
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET POLICY Java Client HTTP Request"; flow:established,to_server; content:" Java/1."; http_user_agent; flowbits:set,ET.http.javaclient; flowbits:noalert; classtype:misc-activity; sid:2013035; rev:2;)
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET POLICY Vulnerable Java Version 1.7.x Detected"; flow:established,to_server; content:" Java/1.7.0_0"; http_user_agent; content:!"7"; within:1; http_user_agent; flowbits:set,ET.http.javaclient.vulnerable; threshold: type limit, count 2, seconds 300, track by_src; reference:url,javatester.org/version.html; classtype:bad-unknown; sid:2014297;rev:12;)
#    alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft OLE Compound File Magic Bytes Flowbit Set"; flow:to_client,established; content:"|d0 cf 11 e0 a1 b1 1a e1|"; content:!".msi"; flowbits:set,OLE.CompoundFile; flowbits:noalert; classtype:protocol-command-decode; sid:2012520; rev:6;)

#####
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"LUAJIT test - match XORed binary"; flowbits:isset,ET.http.javaclient.vulnerable; flowbits:isnotset,ET.http.binary; luajit:suri-xor-binary-detect.lua; filestore:response; sid:379000001; rev:4;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"LUAJIT zip test - Blackhole 2.x Jar"; flowbits:isset,ET.http.javaclient; file_data; content:"PK"; depth:2; luajit:suri-bh2-jar.lua; filestore:response; sid:379000002; rev:2;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"LUAJIT zip test - Blackhole 2.x Jar via vulnerable client"; flowbits:isset,ET.http.javaclient.vulnerable; file_data; content:"PK"; depth:2; luajit:suri-bh2-jar.lua; filestore:response; sid:379000003; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET LUAJIT zip test - Blackhole 2.x <name>[abc].class Jar"; flowbits:isset,ET.http.javaclient; file_data; content:"PK"; depth:2; luajit:suri-bh2-abc-jar.lua; filestore:response; sid:379000004; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET LUAJIT Java Disable Security in Jar CVE-2012-4681"; flow:from_server,established; flowbits:isset,ET.http.javaclient.vulnerable; file_data; content:"PK"; depth:2; luajit:CVE-2012-4681.lua; classtype:trojan-activity; sid:379000005; rev:4;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET LUAJIT WEB_CLIENT Adobe Flash Vuln (CVE-2012-1535 Uncompressed) "; flow:from_server,established; file_data; content:"FWS"; depth:3; luajit:CVE-2012-1535.lua; content:"kern"; fast_pattern:only; classtype:trojan-activity; sid:7016688; rev:4;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET LUAJIT WEB_CLIENT Adobe Flash Vuln (CVE-2012-1535 Compressed)"; flow:from_server,established; file_data; content:"CWS"; depth:3; luajit:CVE-2012-1535.lua; classtype:trojan-activity; sid:7016687; rev:4;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET LUAJIT WEB_CLIENT Adobe Flash Vuln (CVE-2012-1535 Uncompressed) "; flow:from_server,established; file_data; flowbits:isset,OLE.CompoundFile; content:"kern"; fast_pattern:only;  content:"FWS"; luajit:CVE-2012-1535.lua; classtype:trojan-activity; sid:6688; rev:4;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET LUAJIT WEB_CLIENT Adobe Flash Vuln (CVE-2012-1535 Compressed)"; flow:from_server,established; file_data; flowbits:isset,OLE.CompoundFile; content:"CWS"; luajit:CVE-2012-1535.lua; classtype:trojan-activity; sid:6687; rev:4;)

